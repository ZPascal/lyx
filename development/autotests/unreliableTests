# Regular expressions for tests that should not be executed with
# ctest -L export or ctest -L inverted because they do not work as expected
# (either unreliable or invalid).
#
# Patterns will be automatically enclosed with '^' and '$'.
# Matching tests get the label "unreliable" and do not get the label "export".
#
# TODO: Name problem: *invalid* tests (wrong output) are not *unreliable*.
#   Use "unfit" or "unapplicable" as better label and name of pattern file?


Sublabel: nonstandard
#####################
# Documents with additional requirements,
# e.g. a class or package file not in TeXLive.
# TODO: rename to "extra" or "exotic"?

# aa.cls (not in TeXLive).
export/examples/Articles/Astronomy_%26_Astrophysics.*
export/templates/Articles/Astronomy_%26_Astrophysics.*

# AEA.cls (see https://wiki.lyx.org/Examples/AEA)
export/templates/Articles/American_Economic_Association_(AEA).*

# copernicus.cls (not in TeXLive)
# see https://publications.copernicus.org/for_authors/manuscript_preparation.html
export/templates/Articles/Copernicus_Publications_Manuscript_Preparation_.*

# ectaart.cls
# see https://wiki.lyx.org/Examples/Econometrica
export/templates/Articles/Econometrica.*

# iucr.cls (not in TeXLive)
export/templates/Articles/International_Union_of_Crystallography.*

# ws-ijmpc.cls, w-ijmpd.cls
# see https://wiki.lyx.org/Examples/IJMP
export/templates/Articles/Int._Journal_of_Modern_Physics_C.*
export/templates/Articles/Int._Journal_of_Modern_Physics_D.*

# iopart.cls, iopams.sty, setstack.sty
# see https://wiki.lyx.org/Layouts/Iopart
export/templates/Articles/Institute_of_Physics_.*

# jasatex.cls
# see https://wiki.lyx.org/Layouts/JASATeX
export/templates/Articles/Journal_of_the_Acoustical_Society_of_America.*

# jss.cls
export/templates/Articles/Journal_of_Statistical_Software_.*

# LilyPond-book version 2.13 or newer.
export/examples/Modules/LilyPond_Book.*

# maa-monthly.sty (not in TeXLive)
# http://www.maa.org/sites/default/files/pdf/pubs/maa-monthly.sty
export/templates/Articles/Mathematical_Monthly.*

# knitr, RJournal.sty (not in TeXLive)
# incompatible with fontspec?
export/templates/Articles/RJournal_.*

# R (http://www.r-project.org)
# R package knitr (http://yihui.name/knitr)
export/examples/Modules/Sweave.*
export/examples/Modules/Rnw.*knitr.*

# obsolete versions of documentclass or style files
export/templates/Obsolete/.*

# svjour3.cls, svglov2.clo
# see https://wiki.lyx.org/Examples/Springer
export/templates/Articles/Springers_Global_Journal_Template.*

# svmono.cls
templates/examples/Books/Springer_Monographs.*
# svmult.cls
templates/examples/Books/Springer_Contributed_Books.*

# TeXLive does not set up Hebrew 8-bit TeX fonts
# We use the external package culmus-latex
# https://sourceforge.net/projects/ivritex/files/culmus-latex/culmus-latex-0.7/
export/export/latex/unicodesymbols/.*_he.*pdf2
export/export/latex/(supported-languages|he-scrarticle).*
export/.*/he/.*((dvi|pdf.?)|_texF)


Sublabel: needauth
##################
# Tests that require authorisation to call external programs.
export/examples/External_Material/Gnuplot.*
export/examples/Graphics_and_Insets/Minted_File_Listing.*
export/examples/Graphics_and_Insets/Minted_Listings.*


Sublabel: erratic
#################
# Tests depending on local configuration, or the phase of the moon.

# Manual export fails the first time but works the second time. (Why?)
export/doc/es/(Customization|Intro)_pdf4_texF


Sublabel: varying_versions
##########################
# Test depending on e.g. OS or version of a non-TeX-Live dependency.
# Note that a full, up-to-date TeX Live installation is required so this
# sublabel is about versions of other dependencies.

# Encoding cp858 only supported by some iconv variants
# Gnu iconv only supports it, if configured with "--enable-extra-encodings"
# (see https://www.gnu.org/software/libiconv/)
export/export/latex/cp858_pdf2

# Seminar export with LaTeX fails in latest TeXLive:
export/examples/(|fr/)seminar_(dvi|pdf).*

# since TL18, Babel-Ukrainean uses UTF-8 if it detects Xe/LuaTeX (for "\date").
# * garbled output with LuaTeX + TeX fonts (since TL18)
# * missing chars with XeTeX + TeX fonts (see invertedTests)
export/export/latex/uk-babel-date-missing-chars-with-ascii_.*_texF
export/(doc|examples)/uk/(Intro|Welcome)_.*_texF

# new problem with TL18 (see invertedTests)
export/export/latex/luainputenc-utf8_pdf5_texF

# aastex: hard-coded version in class name:
# 2018-05-12 aastex6.cls -> aastex62.cls
export/examples/Articles/American_Astronomical_Society_.*
export/templates/Articles/American_Astronomical_Society_.*

# `acmart` calls "libertine" as default font.
# With TeXLive < 18, this clashes with LyX setting up 8-bit TeX fonts
# PDF (luatex) and PDF (xetex) (compilation error or wrong fonts).
# See also #9744 allow parallel configuration of TeX and non-TeX fonts.
export/templates/Articles/Association_for_Computing_Machinery_pdf[45]_texF

# since TeXLive18, 8-bit LaTeX defaults to utf-8


Sublabel: wrong_output
######################
# Export does not fail but the resulting document has errors.
#
# These tests are actually not "unreliable" (different result for different
# runs) but *invalid* (not measuring what they should measure).

# seminar.sty uses Postscript specials or PGF resulting in problems with slide
# size and orientation depending on the output format and viewing application.
# For details see Troubleshooting and the Appendix in examples/seminar.lyx.
export/examples/(|fr/)Presentations/Seminar_(dvi|pdf).*

# Babel-Spanish uses UTF-8 encoded strings if it detects Xe/LuaTeX.
# With "language default" (=="latin9"), Babel strings  come out wrong
# when compiling with Xe/LuaTeX and TeX-fonts.
# - The problem is generic to all Spanish documents but only manifests itself
#   if Babel strings with non-ASCII chars are actually used
#   (the ToC heading, e.g., becomes "ÃŊndice" instead of "Índice").
# - In some cases, export fails
#   (see invertedTests, some more tests fail with TeXLive versions < 18).
# Should we set inputenc to utf8 in the documents to work around the problem?
# (Changing the default in lib/languages requires more tests for utf8 first.)
export/examples/es/.*_(pdf5|dvi3)_texF
export/doc/es/.*_(pdf5|dvi3)_texF

# since TL18, Babel-Ukrainean uses UTF-8 if it detects Xe/LuaTeX (for "\date").
# * garbled output with LuaTeX + TeX fonts (since TL18)
#   (date and chapter headings)
# * missing chars with XeTeX + TeX fonts (see invertedTests)
export/export/latex/uk-babel-date-missing-chars-with-ascii_.*_texF
export/doc/uk/Intro_.*_texF


# LyX issues
# **********

#6197: „amssymb” with Polish babel: name clash \lll ("<<<" vs. "ł")
# Wrong output with pdflatex
# missing character with XeTeX/LuaTeX and Babel (-> invertedTests)
export/export/latex/6197-polish-amssymb_(dvi|pdf).?

# Non-ASCII char in verbatim environment is dropped (with a warning when
# doing this interactively) with ASCII (and hence also with XeTeX).
export/doc/(|de/|es/|fr/)EmbeddedObjects_pdf4_texF

# The following document mixes inTitle layouts and leads to
# likely unintended output. See #10347
export/export/mixing_inTitle_layouts_(pdf|dvi).*

# Characters with accents are not output
# Reported to LuaTeX mailing list here:
# https://www.mail-archive.com/search?l=mid&q=20160831134006.4fewxothddqfeyw4%40steph
# (not expecting much attention because DVI is not given high priority)
export/doc/es/Customization_dvi3_systemF
export/examples/(|es/)Curricula_Vitae/Europe_CV_dvi3_.*F

# `acmart` requires PDFlatex:
# * Missing page number in DVI, Postscript, and PDF (ps2pdf)
# * "PDF (ps2pdf)" fails (problem with Postscript) in TeXLive < 2018
#   "Postscript" not tested by ctest autotests
export/templates/Articles/Association_for_Computing_Machinery_dvi.*
export/templates/Articles/Association_for_Computing_Machinery_pdf

# lyx2lyx back-conversion of "Date" info-inset writes
# the name of the day in English instead of Japanese.
export/examples/ja/Multilingual_Typesetting_.*_lyx.*

# No localization of auto-strings with Chinese language under 8-bit TeX
# (ctex font issue with texlive-lang-chinese (from Debian) under pdflatex)
# and only partial localization with non-tex-fonts:
export/export/latex/CJK/zh_CN-toc.*
export/doc/zh_CN/(Intro|Tutorial)_(dvi|pdf).?

# Missing Chinese characters in the DVI (LuaTex)
export/doc/zh_CN/(Intro|Tutorial)_dvi3_systemF

# CJK languages don't change/reset the "language" (which is problematic for
# documents in a language that uses a non-standard font encoding)
# In a Greek document, Latin letters in a text part set to "Chinese"
# come out as Greek letters:
export/export/latex/CJK/el-zh_CN_utf8-cjk.*
