# Regular expressions for tests that should not be executed with
# ctest -L export or ctest -L inverted because they do not work as expected
# (either unreliable or invalid).
#
# Patterns will be automatically enclosed with '^' and '$'.
# Matching tests get the label "unreliable" and do not get the label "export".
#
# TODO: Name problem: *invalid* tests (wrong output) are not *unreliable*.
#   Use "unfit" or "unapplicable" as better label and name of pattern file?


Sublabel: nonstandard
#####################
# Documents with additional requirements,
# e.g. a class or package file not in TeXLive.
# TODO: rename to "extra" or "exotic"?

export/templates/IUCr-article_(dvi|pdf).*
export/templates/kluwer_.*_systemF
export/templates/ectaart_(dvi3|pdf5).*

# requires knitr, requires rjournal.sty (not in TeXLive)
# incompatible with fontspec?
export/templates/RJournal_(dvi3|pdf[45])_systemF

# Requires aa.cls (not in TeXLive).
# Fails with XeTeX/LuaTeX
# Reported upstream (https://www.mail-archive.com/lyx-devel@lists.lyx.org/msg184435.html)
# Is there a new version fixing the problem?
export/examples/aa_sample_(dvi3|pdf[45])_.*
export/templates/aa_(dvi3|pdf[45])_.*

# Requires iucr.cls (not in TeXLive)
# Is there a new version fixing the problem?
# Does LuaTeX produce sensible results?
export/templates/IUCr-article_pdf4_systemF

# Requires acmsiggraph.cls (not in TeXLive)
# see http://wiki.lyx.org/Examples/AcmSiggraph
export/templates/obsolete/ACM-siggraph/ACM-siggraph_(dvi|pdf).*

# R (http://www.r-project.org) 
export/examples/sweave.*
# R package knitr (http://yihui.name/knitr)
export/examples/knitr.*

# LilyPond-book version 2.13 or newer.
export/examples/lilypond.*

# svmono.cls
export/examples/springer/svmono.*
# svmult.cls
export/examples/springer/svmult.*

# AEA.cls (see https://wiki.lyx.org/Examples/AEA)
export/templates/AEA.*

# ws-ijmpc.cls, w-ijmpd.cls (see https://wiki.lyx.org/Examples/IJMP)
export/templates/IJMPC.*
export/templates/IJMPD.*

# iopart.cls, iopams.sty, setstack.sty (see https://wiki.lyx.org/Layouts/Iopart)
export/templates/IOP-article.*

# jasatex.cls (see https://wiki.lyx.org/Layouts/JASATeX)
export/templates/JASA.*

# ectaart.cls (see https://wiki.lyx.org/Examples/Econometrica)
export/templates/ectaart.*

# maa-monthly.sty (not in TeXLive)
# http://www.maa.org/sites/default/files/pdf/pubs/maa-monthly.sty
export/templates/maa-monthly.*

# svjour3.cls, svglov2.clo (see https://wiki.lyx.org/Examples/Springer)
export/templates/springer/svjour3.*


Sublabel: needauth
##################
# Tests that require authorisation to call external programs.
export/examples/gnuplot.*
export/examples/minted-filelisting.*
export/examples/minted-listings.*


Sublabel: erratic
#################
# Tests depending on local configuration, or the phase of the moon.

# Manual export fails the first time but works the second time. (Why?)
export/doc/es/(Customization|Intro)_pdf4_texF

# Missing Cyrillic LICR commands (on first run after changing from tex-fonts)
# (leftover *.aux file?)
export/doc/uk/Intro_pdf4_texF


Sublabel: varying_versions
##########################
# Test depending on e.g. OS or version of a non-TeX-Live dependency.
# Note that a full, up-to-date TeX Live installation is required so this
# sublabel is about versions of other dependencies.

# Encoding cp858 only supported by some iconv variants
# Gnu iconv only supports it, if configured with "--enable-extra-encodings"
# (see https://www.gnu.org/software/libiconv/)
export/export/latex/cp858_pdf2

# Seminar export with LaTeX fails in latest TeXLive:
export/examples/(|fr/)seminar_(dvi|pdf).*

# since TeXLive18, 8-bit LaTeX defaults to utf-8
# ----------------------------------------------

# `acmart` calls "libertine" as default font.
# With TeXLive < 18, this clashes with LyX setting up 8-bit TeX fonts
# PDF (luatex) and PDF (xetex) (compilation error or wrong fonts).
# See also #9744 allow parallel configuration of TeX and non-TeX fonts.
export/templates/acmart_pdf[45]_texF


Sublabel: wrong_output
######################
# Export does not fail but the resulting document has errors.
#
# These tests are actually not "unreliable" (different result for different
# runs) but *invalid* (not measuring what they should measure).

# seminar.sty uses Postscript specials or PGF resulting in problems with slide
# size and orientation depending on the output format and viewing application.
# For details see Troubleshooting and the Appendix in examples/seminar.lyx.
export/examples/(|fr/)seminar_(dvi|pdf).*

# Babel-Spanish uses UTF-8 encoded strings if it detects Xe/LuaTeX.
# With "language default" (=="latin9"), Babel strings  come out wrong
# when compiling with Xe/LuaTeX and TeX-fonts.
# - The problem is generic to all Spanish documents but only manifests itself
#   if Babel strings with non-ASCII chars are actually used
#   (the ToC heading, e.g., becomes "ÃŊndice" instead of "Índice").
# - In some cases, export fails
#   (see invertedTests, some more tests fail with TeXLive versions < 18).
# Should we set inputenc to utf8 in the documents to work around the problem?
# (Changing the default in lib/languages requires more tests for utf8 first.)
export/examples/es/(ejemplo_con_lyx|tufte_book)_(pdf5|dvi3)_texF
export/doc/es/.*_(pdf5|dvi3)_texF

# LyX issues
# **********

#6197: „amssymb” with Polish babel: name clash \lll ("<<<" vs. "ł")
# Wrong output with pdflatex
# missing character with XeTeX/LuaTeX and Babel (-> invertedTests)
export/export/latex/6197-polish-amssymb_(dvi|pdf).?

#9681 Run-together words if language is set to Greek
# if inputenc is 8-bit "language default".
# See https://www.lyx.org/trac/ticket/9681#comment:6
# TODO: add separate bug for:
# Definition of "\LyX" needs "\textlatin" in Greek (printed as "ΛΨΞ").
export/.*/el/.*(_texF|(dvi|pdf.?))

# Non-ASCII char in verbatim environment is dropped (with a warning when
# doing this interactively) with ASCII (and hence also with XeTeX).
export/doc/(|de/|es/|fr/)EmbeddedObjects_pdf4_texF

# The following document mixes inTitle layouts and leads to
# likely unintended output. See #10347
export/export/mixing_inTitle_layouts_(pdf|dvi).*

# Characters with accents are not output
# Reported to LuaTeX mailing list here:
# https://www.mail-archive.com/search?l=mid&q=20160831134006.4fewxothddqfeyw4%40steph
# (not expecting much attention because DVI is not given high priority)
export/doc/es/Customization_dvi3_systemF
export/examples/(|es/)(europe|modern)CV_dvi3_systemF

# No termination of LICR macros when textcyr and textgreek is not required
# Cf. #9637 textgreek and textcyr depend on font-encoding, not input encoding
# -> original problem fixed but run-together words in Russian (and Greek)
export/export/latex/ru-accent-ascii_pdf2
export/export/latex/unicodesymbols/009-cyrillic_ru_euc-cn_pdf2

# `acmart` requires PDFlatex:
# * Missing page number in DVI, Postscript, and PDF (ps2pdf)
# * "PDF (ps2pdf)" fails (problem with Postscript) in TeXLive < 2018
export/templates/acmart_dvi.*
#export/templates/acmart_ps # not tested by ctest autotests
export/templates/acmart_pdf

# lyx2lyx back-conversion of "Date" info-inset writes
# the name of the day in English instead of Japanese.
export/examples/ja/multilingual_lyx.*

# No localization of auto-strings with Chinese language under 8-bit TeX
# (ctex font issue with texlive-lang-chinese (from Debian) under pdflatex)
# and only partial localization with non-tex-fonts:
export/export/latex/CJK/zh_CN-toc.*
export/doc/zh_CN/(Intro|Tutorial)_(dvi|pdf).?

# Missing Chinese characters in the DVI (LuaTex)
export/doc/zh_CN/(Intro|Tutorial)_dvi3_systemF

# CJK languages don't change/reset the "language" (which is problematic for
# documents in a language that uses a non-standard font encoding)
# In a Greek document, Latin letters in a text part set to "Chinese"
# come out as Greek letters:
export/export/latex/CJK/el-zh_CN_utf8-cjk.*
